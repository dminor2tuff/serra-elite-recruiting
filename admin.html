<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Serra Admin Tools</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;background:#f5f7fb;margin:0}
.wrap{max-width:900px;margin:30px auto;padding:0 16px}
.box{
  background:white;border-radius:16px;padding:20px;
  box-shadow:0 4px 14px rgba(0,0,0,.08);margin-bottom:18px;
}
h1,h2{color:#002b5c}
label{font-size:.85rem;font-weight:700;display:block;margin-top:8px}
input,textarea{
  width:100%;padding:8px;margin-top:4px;
  border-radius:8px;border:1px solid #ccc;font-size:.9rem;
}
textarea{min-height:70px}
button{
  margin-top:10px;padding:8px 18px;border:none;
  border-radius:999px;background:#002b5c;color:white;
  font-weight:700;cursor:pointer;font-size:.9rem;
}
.small{font-size:.85rem;color:#555}
.hidden{display:none}
.code{background:#eef1f8;padding:8px;border-radius:8px;font-family:monospace;font-size:.8rem}
.row-list{max-height:240px;overflow:auto;border:1px solid #ddd;border-radius:10px;padding:8px;font-size:.85rem;background:#fafbff}
.row-list div{padding:3px 0;border-bottom:1px solid #eee}
.row-list span{font-weight:700;color:#002b5c;cursor:pointer}
</style>
</head>

<body>
<div class="wrap">

  <div id="loginBox" class="box">
    <h1>Serra Admin – Coach Tools</h1>
    <p class="small">Restricted to Serra Football staff.</p>
    <label>Coach Access Code</label>
    <input id="pw" type="password" placeholder="Enter password">
    <button onclick="login()">Enter</button>
    <p id="err" style="color:#b00020;display:none;margin-top:6px;">Incorrect password</p>
  </div>

  <div id="adminArea" class="hidden">

    <div class="box">
      <h2>Google Sheet Header (copy this exactly)</h2>
      <div class="code">
        Name | Class | Position | HeightWeight | HUDL | Writeup | ImageURL | Twitter | GPA | Offers | Status | College | CollegeLogoURL
      </div>
      <p class="small">
        All edits happen in the Google Sheet. This page helps you build clean rows and URLs.
      </p>
    </div>

    <div class="box">
      <h2>Current Players (click to load into builder)</h2>
      <div id="playerRows" class="row-list">Loading…</div>
    </div>

    <div class="box">
      <h2>Player Row Builder</h2>
      <p class="small">Build or edit a player row, then paste into the Google Sheet.</p>

      <label>Name</label><input id="pName">
      <label>Class</label><input id="pClass">
      <label>Position</label><input id="pPos">
      <label>Height / Weight</label><input id="pHW">
      <label>HUDL URL</label><input id="pHudl">
      <label>Twitter URL</label><input id="pTwitter">
      <label>GPA</label><input id="pGpa">
      <label>Offers</label><input id="pOffers">
      <label>Status (e.g. Offered, Committed, Target)</label><input id="pStatus">
      <label>College (e.g. USC)</label><input id="pCollege">
      <label>College Logo URL</label><input id="pCollegeLogo">
      <label>Writeup</label><textarea id="pWriteup"></textarea>
      <label>ImageURL</label><input id="pImg">

      <button onclick="buildRow()">Generate Sheet Row</button>

      <label style="margin-top:12px;">Copy-Paste into Sheet (one row):</label>
      <textarea id="rowOutput" readonly></textarea>
    </div>

    <div class="box">
      <h2>Image URL Helper</h2>
      <p class="small">All images must live in <code>/images/</code> in this GitHub repo.</p>
      <label>Player photo filename (e.g. devohn_moutra.png)</label>
      <input id="imgFile">
      <button onclick="buildImgUrl()">Generate ImageURL</button>
      <textarea id="imgOutput" readonly></textarea>
    </div>

  </div>
</div>

<script>
const SHEET =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRZdfePIY8K8ag6AePllWRgYXhjJ-gJddB_8rDaJi3t5BAT11bHVK6m5cDsDQXg2PUIYPqHYcXyxbT2/pub?output=csv";
const ADMIN_CODE="SerraFB";
let adminPlayers=[];

function login(){
  const v=document.getElementById("pw").value.trim();
  if(v===ADMIN_CODE){
    document.getElementById("loginBox").style.display="none";
    document.getElementById("adminArea").classList.remove("hidden");
    loadPlayers();
  }else{
    document.getElementById("err").style.display="block";
  }
}

async function loadPlayers(){
  const res=await fetch(SHEET);
  const text=await res.text();
  const rows=text.split("\\n").map(r=>r.split(","));
  const headers=rows[0];

  adminPlayers=rows.slice(1).map(r=>{
    if(!r[0])return null;
    const p={};
    headers.forEach((h,i)=>p[h.trim()]=(r[i]||"").trim());
    return p;
  }).filter(Boolean);

  const box=document.getElementById("playerRows");
  box.innerHTML="";
  adminPlayers.forEach((p,i)=>{
    const div=document.createElement("div");
    div.innerHTML=`<span data-i="${i}">${p.Name}</span> – Class ${p.Class} • ${p.Position}`;
    box.appendChild(div);
  });

  box.onclick=e=>{
    const span=e.target.closest("span[data-i]");
    if(!span)return;
    const idx=+span.dataset.i;
    fillBuilder(adminPlayers[idx]);
  };
}

function fillBuilder(p){
  pName.value=p.Name||"";
  pClass.value=p.Class||"";
  pPos.value=p.Position||"";
  pHW.value=p.HeightWeight||"";
  pHudl.value=p.HUDL||"";
  pTwitter.value=p.Twitter||"";
  pGpa.value=p.GPA||"";
  pOffers.value=p.Offers||"";
  pStatus.value=p.Status||"";
  pCollege.value=p.College||"";
  pCollegeLogo.value=p.CollegeLogoURL||"";
  pWriteup.value=p.Writeup||"";
  pImg.value=p.ImageURL||"";
  buildRow();
}

function buildRow(){
  const row=[
    pName.value.trim(),
    pClass.value.trim(),
    pPos.value.trim(),
    pHW.value.trim(),
    pHudl.value.trim(),
    pWriteup.value.trim(),
    pImg.value.trim(),
    pTwitter.value.trim(),
    pGpa.value.trim(),
    pOffers.value.trim(),
    pStatus.value.trim(),
    pCollege.value.trim(),
    pCollegeLogo.value.trim()
  ].join(" | ");
  rowOutput.value=row;
}

function buildImgUrl(){
  const file=(imgFile.value||"").trim();
  if(!file){
    imgOutput.value="Enter a filename first, e.g. devohn_moutra.png";
    return;
  }
  imgOutput.value=
    "https://dminor2tuff.github.io/serra-elite-recruiting/images/"+file;
}
</script>

</body>
</html>