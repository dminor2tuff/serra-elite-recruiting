<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Serra Recruiting Board</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="styles.css">
</head>

<body>

<!-- NAV -->
<nav>
  <img src="images/serra_logo.png" alt="Serra Football Logo">
  <div>
    <a href="index.html">Home</a>
    <a href="transcript_request.html">Transcript Request</a>
    <a href="admin.html">Coach Tools</a>
  </div>
</nav>

<!-- HEADER -->
<header style="
  padding:90px 20px;
  background:
    linear-gradient(rgba(0,0,0,.65),rgba(0,0,0,.85)),
    url('images/serra_action.png') center/cover no-repeat;
  color:#fff;
  text-align:center;
">
  <h1>Serra Recruiting Board</h1>
  <p>Verified Serra Football Prospects</p>
</header>

<!-- LOGIN -->
<section class="section" id="login">
  <h2>Coach Access</h2>
  <p>This recruiting board is restricted to verified college coaches.</p>

  <input type="password" id="pw" placeholder="Enter access password">
  <button onclick="unlock()">Enter</button>
</section>

<!-- BOARD -->
<section class="section" id="board" style="display:none">
  <h2>Prospects</h2>

  <!-- CLASS FILTERS -->
  <div style="
    margin-bottom:26px;
    display:flex;
    flex-wrap:wrap;
    gap:10px;
  ">
    <button onclick="setFilter('All')" class="btn">All</button>
    <button onclick="setFilter('2026')" class="btn">2026</button>
    <button onclick="setFilter('2027')" class="btn">2027</button>
    <button onclick="setFilter('2028')" class="btn">2028</button>
    <button onclick="setFilter('2029')" class="btn">2029</button>
  </div>

  <!-- PLAYERS GRID -->
  <div id="players" style="
    display:grid;
    grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
    gap:24px;
  "></div>
</section>

<script>
const ACCESS_PASSWORD = "SerraFB";

const SHEET_URL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRZdfePIY8K8ag6AePllWRgYXhjJ-gJddB_8rDaJi3t5BAT11bHVK6m5cDsDQXg2PUIYPqHYcXyxbT2/pub?output=csv";

let allPlayers = [];
let currentFilter = "All";

function unlock() {
  if (document.getElementById("pw").value === ACCESS_PASSWORD) {
    document.getElementById("login").style.display = "none";
    document.getElementById("board").style.display = "block";
    loadPlayers();
  } else {
    alert("Invalid password");
  }
}

function setFilter(cls) {
  currentFilter = cls;
  renderPlayers();
}

function loadPlayers() {
  fetch(SHEET_URL)
    .then(res => res.text())
    .then(csv => {
      const rows = csv.split("\n").slice(1);
      allPlayers = [];

      rows.forEach(r => {
        if (!r.trim()) return;
        const c = r.split(",");

        const name = c[0] || "";
        if (!name) return;

        allPlayers.push({
          name: name,
          classYear: c[1] || "",
          position: c[2] || "",
          size: c[3] || "",
          image: c[6] || "images/placeholder_player.png",
          twitterRaw: c[7] || ""
        });
      });

      renderPlayers();
    });
}

function renderPlayers() {
  let html = "";

  allPlayers.forEach(p => {
    if (currentFilter !== "All" && p.classYear !== currentFilter) return;

    let twitterLink = "";
    if (p.twitterRaw) {
      twitterLink = p.twitterRaw.startsWith("http")
        ? p.twitterRaw
        : `https://twitter.com/${p.twitterRaw.replace("@","")}`;
    }

    html += `
      <div class="card">
        <img src="${p.image}" style="width:100%;border-radius:12px;margin-bottom:12px;">

        <strong>${p.name}</strong><br>
        <small>${p.position} ‚Ä¢ Class of ${p.classYear}</small><br>
        <small>${p.size}</small><br><br>

        ${twitterLink ? `
          <a href="${twitterLink}" target="_blank"
             style="display:inline-block;margin-bottom:10px;font-weight:600;">
             üê¶ Twitter / X
          </a><br>
        ` : ``}

        <a href="profile.html?name=${encodeURIComponent(p.name)}"
           class="btn"
           style="padding:10px 22px;font-size:.85rem;">
           View Profile
        </a>
      </div>
    `;
  });

  document.getElementById("players").innerHTML =
    html || "<p>No prospects available for this class.</p>";
}
</script>

</body>
</html>