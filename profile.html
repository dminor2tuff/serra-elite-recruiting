<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Player Profile</title>
<link rel="stylesheet" href="styles.css">
</head>

<body>

<header class="site-header">
  <a href="recruits.html">â† Back to Recruits</a>
</header>

<section class="profile-container" id="profile"></section>

<script>
const csvURL =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vRZdfePIY8K8ag6AePllWRgYXhjJ-gJddB_8rDaJi3t5BAT11bHVK6m5cDsDQXg2PUIYPqHYcXyxbT2/pub?output=csv";

const params = new URLSearchParams(window.location.search);
const slug = params.get("player");

function slugify(text) {
  return text.toLowerCase()
    .replace(/,/g,"")
    .replace(/\s+/g,"-")
    .replace(/[^a-z0-9-]/g,"");
}

fetch(csvURL)
  .then(r => r.text())
  .then(csv => {
    const rows = csv.split("\n").slice(1);
    const container = document.getElementById("profile");

    rows.forEach(row => {
      const c = row.split(",");
      if (slugify(c[0]) !== slug) return;

      container.innerHTML = `
        <img class="profile-photo"
          src="${c[6]}"
          onerror="this.src='images/placeholder_player.png'">

        <h1>${c[0]}</h1>
        <p><strong>${c[2]}</strong></p>
        <p>Class of ${c[1]} â€¢ ${c[3]}</p>
        <p><strong>GPA:</strong> ${c[8]}</p>

        <p>${c[5]}</p>

        <div class="icon-links">
          ${c[4] ? `<a href="${c[4]}" target="_blank">ğŸ¥ Hudl</a>` : ""}
          ${c[7] ? `<a href="${c[7]}" target="_blank">ğŸ¦ Twitter</a>` : ""}
        </div>
      `;
    });
  });
</script>

</body>
</html>