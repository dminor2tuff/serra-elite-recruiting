<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Serra Player Profile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      margin:0;
      background:#f5f7fb;
      color:#111;
    }
    .wrap {
      max-width:900px;
      margin:20px auto 40px;
      padding:0 16px;
    }
    a.back {
      display:inline-block;
      margin-bottom:12px;
      text-decoration:none;
      color:#002b5c;
      font-weight:700;
    }
    .card {
      background:#fff;
      padding:20px;
      border-radius:18px;
      box-shadow:0 4px 14px rgba(0,0,0,0.08);
      display:flex;
      flex-wrap:wrap;
      gap:20px;
    }
    .photo {
      flex:0 0 220px;
    }
    .photo img {
      width:100%;
      border-radius:16px;
      object-fit:cover;
    }
    h1 {
      margin:0 0 8px;
      color:#002b5c;
    }
    .meta {
      font-size:0.95rem;
      color:#444;
      margin-bottom:10px;
    }
    .tags span {
      display:inline-block;
      background:#eef1f8;
      padding:4px 8px;
      border-radius:999px;
      font-size:0.8rem;
      margin-right:6px;
      margin-bottom:6px;
    }
    .links a {
      display:inline-block;
      margin-right:10px;
      margin-top:6px;
      font-size:0.85rem;
      text-decoration:none;
      color:#002b5c;
    }
    .bio {
      margin-top:16px;
      line-height:1.6;
    }
  </style>
</head>

<body>
<div class="wrap">
  <a class="back" href="serra_prospect_list.html">← Back to Serra Recruits</a>

  <div class="card">
    <div class="photo">
      <img id="photo" src="images/placeholder_player.png" alt="Player photo">
    </div>
    <div class="info">
      <h1 id="name">Loading…</h1>
      <div id="meta" class="meta"></div>
      <div id="tags" class="tags"></div>
      <div id="links" class="links"></div>
      <div id="bio" class="bio"></div>
    </div>
  </div>
</div>

<script>
const SHEET_URL =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vRZdfePIY8K8ag6AePllWRgYXhjJ-gJddB_8rDaJi3t5BAT11bHVK6m5cDsDQXg2PUIYPqHYcXyxbT2/pub?output=csv";
const PLACEHOLDER_IMG = "images/placeholder_player.png";

const params = new URLSearchParams(location.search);
const playerName = params.get("name");

if (!playerName) {
  document.getElementById("name").innerText = "Player not found";
} else {
  loadPlayer();
}

async function loadPlayer(){
  const res = await fetch(SHEET_URL);
  const text = await res.text();
  const rows = text.split("\n").map(r => r.split(","));
  const headers = rows[0];

  const players = rows.slice(1)
    .map(r=>{
      if (!r[0]) return null;
      const obj = {};
      headers.forEach((h,i)=>obj[h.trim()] = (r[i] || "").trim());
      return obj;
    })
    .filter(Boolean);

  const p = players.find(p => p.Name === playerName);
  if (!p) {
    document.getElementById("name").innerText = "Player not found";
    return;
  }

  document.getElementById("name").innerText = p.Name;
  document.getElementById("meta").innerText =
    [p.Class, p.Position, p.HeightWeight].filter(Boolean).join(" • ");

  const tags = [];
  if (p.GPA) tags.push("GPA " + p.GPA);
  if (p.Twitter) tags.push("Active on Twitter");
  const tagsDiv = document.getElementById("tags");
  tagsDiv.innerHTML = tags.map(t=>`<span>${t}</span>`).join("");

  const links = [];
  if (p.HUDL) links.push(`<a href="${p.HUDL}" target="_blank">HUDL</a>`);
  if (p.Twitter) links.push(`<a href="${p.Twitter}" target="_blank">Twitter</a>`);
  document.getElementById("links").innerHTML = links.join("");

  document.getElementById("bio").innerText = p.Writeup || "";

  document.getElementById("photo").src = p.ImageURL || PLACEHOLDER_IMG;
}
</script>
</body>
</html>
