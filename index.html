<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Serra Elite Recruiting</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f4f4f4; }
    header { background:#0A1A44; color:white; padding:35px; text-align:center; border-bottom:6px solid #C41230; position:relative; }
    header img { height:75px; }
    .container { max-width: 1100px; margin: auto; padding: 20px; }

    nav { background:#0A1A44; color:white; padding:12px 20px; display:flex; gap:25px; font-size:18px; }
    nav a { color:white; text-decoration:none; }

    .player-card { background:white; padding:20px; margin:15px 0; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); cursor:pointer; transition:transform 0.15s ease, box-shadow 0.15s ease; }
    .player-card:hover { transform:translateY(-3px); box-shadow:0 4px 10px rgba(0,0,0,0.18); }

    .player-header { display:flex; align-items:center; gap:20px; }
    .player-header img { width:150px; height:180px; object-fit:cover; border-radius:10px; background:#ddd; border:4px solid #0A1A44; }

    h1 { margin:0; }
    h2 { margin:0; }
    .section h3 { color:#0A1A44; border-left:5px solid #C41230; padding-left:8px; }

    .class-filter { margin:15px 0; display:flex; gap:20px; flex-wrap:wrap; align-items:center; }

    select, input { padding:8px; font-size:16px; }

    .btn { display:inline-block; padding:8px 14px; border-radius:6px; border:none; font-size:14px; cursor:pointer; }
    .btn-primary { background:#C41230; color:white; }
    .btn-outline { background:white; color:#C41230; border:1px solid #C41230; }

    footer { background:#0A1A44; color:white; padding:25px; text-align:center; border-top:6px solid #C41230; margin-top:40px; }
  </style>
</head>

<body style="background:url('https://upload.wikimedia.org/wikipedia/commons/4/43/American_football_texture.jpg') repeat; background-size:600px;">

<header>
  <img src="assets/img/serra-logo.png" style="position:absolute; left:25px; top:20px;">
  <img src="assets/img/serra-logo.png" style="position:absolute; right:25px; top:20px;">
  <h1 style="font-size:40px; font-weight:900;">Serra Cavaliers Elite Recruiting Board</h1>
  <p style="font-size:20px;">Serra Cavaliers • Gardena, California • Powered by Legacy Lab</p>
</header>

<button class="btn btn-outline" style="position:fixed; top:10px; right:10px;" onclick="coachLogin()">Coach Login</button>

<nav>
  <a href="#" onclick="showRoster('all')">Home</a>
  <a href="#" onclick="showRoster('2026')">Class of 2026</a>
  <a href="#" onclick="showRoster('2027')">Class of 2027</a>
  <a href="#" onclick="showRoster('2028')">Class of 2028</a>
  <a href="#" onclick="showRoster('2029')">Class of 2029</a>
</nav>

<!-- HERO SECTION -->
<section style="background:url('assets/img/serra-hero.jpg') center/cover no-repeat; padding:80px 20px; text-align:center; color:white; border-bottom:6px solid #C41230;">
  <h1 style="font-size:48px; font-weight:900;">Serra Cavaliers Football Recruiting</h1>
  <p style="font-size:22px;">Showcasing elite student-athletes from Gardena, California — built on speed, discipline, and championship standards.</p>
  <button onclick="showRoster('all')" class="btn btn-primary" style="font-size:18px;">View All Athletes</button>
</section>

<!-- WHY SERRA -->
<section style="background:white; padding:50px 20px; border-bottom:6px solid #C41230;">
  <h2 style="text-align:center; font-size:36px; color:#0A1A44;">Why Serra Football?</h2>
  <div style="max-width:900px; margin:auto; font-size:18px;">
    <p><strong>Championship Culture:</strong> Built on accountability, discipline, and elite standards.</p>
    <p><strong>Recruiting Pipeline:</strong> Dozens of college athletes developed across all levels.</p>
    <p><strong>Speed & Development:</strong> Emphasis on speed, strength, academics, and character.</p>
  </div>
</section>

<!-- QR CODE -->
<section style="background:#0A1A44; padding:50px; color:white; text-align:center;">
  <h2 style="font-size:34px;">Quick Access for College Coaches</h2>
  <p>Scan the QR code to access Serra’s recruiting board & athlete profiles.</p>
  <img src="assets/img/qr-serra.png" style="width:200px; height:200px; border:4px solid white; border-radius:8px;">
</section>

<div class="container">

  <!-- SEARCH + FILTERS -->
  <div class="class-filter">
    <strong>Filter by Class:</strong>
    <select id="classFilter" onchange="filterClass()">
      <option value="all">All Classes</option>
      <option value="2026">2026</option>
      <option value="2027">2027</option>
      <option value="2028">2028</option>
      <option value="2029">2029</option>
    </select>

    <strong>Search:</strong>
    <input id="searchBar" onkeyup="searchPlayers()" placeholder="Search players...">
  </div>

  <!-- AUTO ROSTER -->
  <div id="auto-roster"></div>

  <!-- ADMIN DASHBOARD -->
  <section id="adminDashboard" style="display:none; background:white; padding:25px;">
    <h2 style="color:#0A1A44;">Admin Dashboard</h2>
    <button class="btn btn-primary" onclick="loadAdminRoster()">Load Roster</button>

    <table id="adminTable" style="width:100%; border-collapse:collapse; display:none;">
      <thead>
        <tr style="background:#0A1A44; color:white;">
          <th>Name</th><th>Class</th><th>Position</th><th>Ht/Wt</th><th>HUDL</th><th>Twitter</th><th>GPA</th><th>Actions</th>
        </tr>
      </thead>
      <tbody id="adminBody"></tbody>
    </table>

    <hr>

    <h3>Add / Edit Player</h3>

    <div style="display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:10px;">
      <div><label>Name</label><input id="ad_name"></div>
      <div><label>Class</label><input id="ad_class"></div>
      <div><label>Position</label><input id="ad_pos"></div>
      <div><label>Height/Weight</label><input id="ad_hw"></div>
      <div><label>HUDL</label><input id="ad_hudl"></div>
      <div><label>ImageURL</label><input id="ad_img"></div>
      <div><label>Twitter</label><input id="ad_twitter"></div>
      <div><label>GPA</label><input id="ad_gpa"></div>
    </div>

    <label>Write-Up</label>
    <textarea id="ad_write" rows="4"></textarea>

    <button class="btn btn-primary" onclick="generateAdminRow()">Generate Row</button>
    <button class="btn btn-outline" onclick="clearAdminEditor()">Clear</button>

    <textarea id="ad_output" rows="3" style="width:100%; margin-top:10px;"></textarea>
  </section>

  <!-- TRANSCRIPTS -->
  <section style="background:white; padding:25px; border-radius:10px; margin-top:40px;">
    <h2 style="color:#0A1A44;">Transcripts</h2>
    <p>Official Serra High School transcripts are issued upon verified recruiter request.</p>

    <button class="btn btn-primary" onclick="window.location.href='mailto:serracavsfb@gmail.com?subject=Transcript Request&body=I would like to request an official transcript for: ';">Request Transcript</button>

    <h3 style="margin-top:30px;">Transcript Request Form</h3>
    <form onsubmit="submitTranscriptForm(event)">
      <label>Coach Name</label>
      <input id="tCoach">

      <label>College / University</label>
      <input id="tSchool">

      <label>Player Name</label>
      <input id="tPlayer">

      <label>Email to Receive Transcript</label>
      <input id="tEmail" type="email">

      <button class="btn btn-outline" type="submit" style="margin-top:10px;">Submit Request</button>
    </form>
  </section>

</div>

<footer>
  <p style="font-weight:600;">Serra Cavaliers Football – Gardena, CA</p>
  <p>Coach Darrin Minor • Recruiting Coordinator</p>
  <p>Email: serracavsfb@gmail.com</p>
  <p>Official Recruiting Site: SerraFBrecruits.com</p>
</footer>

<script>
  const GOOGLE_SHEET_ID = "1k2YS5JkrjIJDlI4rdQT58STmnu03QPpBg2BT7dzyBpo";
  const SHEET_NAME = "Roster";
  const SHEET_URL = `https://docs.google.com/spreadsheets/d/${GOOGLE_SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}`;

  function normalize(h){ return h ? h.replace(/\s+/g,'').toLowerCase() : ""; }
  function safe(v){ return v ? v.toString().trim() : ""; }

  async function loadRosterFromSheets() {
    try {
      const res = await fetch(SHEET_URL);
      const text = await res.text();
      const json = JSON.parse(text.substr(47).slice(0,-2));
      const cols = json.table.cols;
      const rows = json.table.rows;

      const map={}; cols.forEach((c,i)=>map[normalize(c.label)]=i);

      const COL={
        name:map["name"], class:map["class"], pos:map["position"],
        hw:map["heightweight"], hudl:map["hudl"], write:map["writeup"],
        img:map["imageurl"], twitter:map["twitter"], gpa:map["gpa"]
      };

      let out="";

      rows.forEach(r=>{
        const name=safe(r.c[COL.name]?.v); if(!name)return;

        const cl=safe(r.c[COL.class]?.v);
        const pos=safe(r.c[COL.pos]?.v);
        const hw=safe(r.c[COL.hw]?.v);
        const hudl=safe(r.c[COL.hudl]?.v);
        const write=safe(r.c[COL.write]?.v);
        const twitter=safe(r.c[COL.twitter]?.v);
        const gpa=safe(r.c[COL.gpa]?.v);

        let img=safe(r.c[COL.img]?.v);
        if(!img || !img.startsWith("http")) img="assets/img/default-player.png";

        let hudlHTML = hudl ? `<a href="${hudl}" target="_blank">HUDL Link</a>` : "No HUDL Available";

        let twHTML="No Twitter";
        if(twitter){
          const h=twitter.replace('@','');
          twHTML=`<a href="https://twitter.com/${h}" target="_blank">@${h}</a>`;
        }

        out+=`
<div class="player-card" data-class="${cl}">
  <div class="player-header">
    <img src="${img}">
    <div>
      <h2>${name}</h2>
      <p><strong>Position:</strong> ${pos}</p>
      <p><strong>Class:</strong> ${cl}</p>
      <p><strong>Ht/Wt:</strong> ${hw}</p>
      <p><strong>School:</strong> Serra High School (Gardena, CA)</p>
    </div>
  </div>

  <div class="section">
    <h3>HUDL / Film</h3>
    ${hudlHTML}
  </div>

  <div class="section">
    <h3>Twitter</h3>
    ${twHTML}
  </div>

  <div class="section">
    <h3>GPA</h3>
    <p>${gpa || '—'}</p>
  </div>

  <div class="section">
    <h3>Write-Up</h3>
    <p>${write}</p>
  </div>
</div>`;
      });

      document.getElementById("auto-roster").innerHTML=out;
    } catch(err){ console.error(err); }
  }

  function filterClass(){
    const y=document.getElementById("classFilter").value;
    document.querySelectorAll(".player-card").forEach(c=>{
      c.style.display=(y==="all"||c.dataset.class===y)?"block":"none";
    });
  }

  function searchPlayers(){
    const term=document.getElementById("searchBar").value.toLowerCase();
    const f=document.getElementById("classFilter").value;
    document.querySelectorAll(".player-card").forEach(c=>{
      const t=c.innerText.toLowerCase();
      const match=t.includes(term) && (f==="all"||c.dataset.class===f);
      c.style.display=match?"block":"none";
    });
  }

  function showRoster(y){
    document.getElementById("classFilter").value=y==="all"?"all":y;
    searchPlayers();
  }

  document.addEventListener("click",e=>{
    const card=e.target.closest(".player-card");
    if(!card)return;
    const modal=document.getElementById("profileModal");
    document.getElementById("modalTitle").textContent=card.querySelector("h2").textContent;
    document.getElementById("modalBody").innerHTML=card.innerHTML;
    document.getElementById("modalBackdrop").style.display="flex";
  });

  function closeProfile(e){
    if(e)e.stopPropagation();
    document.getElementById("modalBackdrop").style.display="none";
  }

  function coachLogin(){
    const p=prompt("Enter coach password:");
    if(p==="Serrafootball"){
      document.getElementById("adminDashboard").style.display="block";
      location.hash="#adminDashboard";
    } else if(p!==null){
      alert("Incorrect password.");
    }
  }

  function submitTranscriptForm(e){
    e.preventDefault();
    const coach=document.getElementById("tCoach").value;
    const school=document.getElementById("tSchool").value;
    const player=document.getElementById("tPlayer").value;
    const email=document.getElementById("tEmail").value;

    const mailto=`mailto:serracavsfb@gmail.com?subject=Transcript Request - ${player}
&body=Coach,%0D%0ARequesting transcript for:%0D%0APlayer: ${player}%0D%0ACollege: ${school}%0D%0ACoach: ${coach}%0D%0AReceiver Email: ${email}`;
    window.location.href=mailto;
  }

  window.addEventListener("load",loadRosterFromSheets);
</script>

</body>
</html>
